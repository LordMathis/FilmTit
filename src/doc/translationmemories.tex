\section{Movie Subtitles}
\subsection{Subtitles in General}

Subtitles are textual versions of the dialog in films or television shows which are shown on the screen at the same time as the dialogs are performed. The most common reason to show the subtitles is either to allow deaf or hard-of-hearing viewers to follow the dialogs or to allow viewers who are not speakers of the language used in the movie to understand the movie while hearing the original sound track. The major difference between these two types of subtitling is that the subtitles for deaf people usually contain not only the dialogs themselves, but also additional information, e.g.\ that music is playing or a description of background noises important for the story.

Originally, the subtitles used to be chemically corroded or laser burnt into the film tape. With the advent of digital technology, the subtitles can be added dynamically to the screen and do not have to be an actual part of the movie. Moreover, they can be distributed independently of the movie.

Subtitles on DVDs are stored in a bitmap format within the movie itself.\footnote{Although official DVD documentation is not available online for free, you can find some information on the DVD project on sourceforge - \url{http://dvd.sourceforge.net/spu_notes}} With the occurrence of unofficial movie file sharing, bitmap files became too big to distribute, so several unofficial formats, based on text, were created.

In those cases, the subtitles -- now in text format instead of bitmap, as in DVD -- are in a standalone file which contains the actual subtitles and some meta data telling the media players which subtitle items should be displayed at which time interval of the video playback.

We do not deal with the type of subtitle that are in non-textual formats at all; all subtitles we have in our database and that users translate are only textual.

\subsection{Translating Subtitles}
Professional translation of movie subtitles and unofficial fan translation is very different for several reasons.

While making a professional translation of the subtitles, the translators can see the whole screenplay of the movie, accompanied with a lot of notes concerning the expressiveness of the utterances and using the rhetorical devices (culture references, sarcasm etc.), on the other hand they often do not see the movie at all.\footnote{For an illustration, how script, given to a translator may look like, see \url{http://www.flickr.com/photos/fuxoft/5731288526/in/photostream/}; also you can read some articles about creating movie translations (in Czech) \url{http://www.fffilm.name/search/label/titulky}}
They usually make changes to the timings to better fit on the screen, have the same number of syllables (in cases of dubbing), and so on. They are equipped with the same tools as other professional translators, such as translation memories or glossaries for checking the consistence of the used vocabulary.

On the other hand, fan translators use simple editors without any special functionality but they usually watch the movie during translation. They usually have pre-existing English subtitles from unofficial sources, which they simply translate without much retiming, subtitle splitting or anything else.

We want to target specifically the second kind of user.

\subsection{Subtitle Formats}
\label{subtitle_formats}

There are two formats of subtitles that are widely used in unofficial movie sharing.

The most widely used is the SubRip SRT format. Sometimes also MicroDVD sub format is used. An example of the formats can be found in table~\ref{subtitleFormats}. According to the database we received from OpenSubtitles.org (the database will be described later), more than 99\% of subtitles are in SRT format.
%(more than 90\,\% of files on opensubtitles.org).

\begin{table}
\begin{center}
\begin{tabular}{cc}
\fbox{\parbox{7.5cm}{\tt4\\
00:02:04,718 \subarrow 00:02:08,054\\
I just want to be alone with her\\
and hold her and kiss her\\
\\
5\\
00:02:08,179 \subarrow 00:02:12,309\\
and tell her how much l love her\\
and take care of her.\\
}} & \fbox{\parbox{7.5cm}{\tt
\{1025\}\{1110\}I just want to be alone with her|and hold her and kiss her\\

\{1375\}\{1460\}and tell her how much l love her|and take care of her.
}}
\end{tabular}
\end{center}

\caption{An example of the subtitle file formats, \emph{srt} at the left, \emph{sub} at the right side.}
\label{subtitleFormats}
\end{table}

\emph{SRT} or \emph{SubRip} is a format from the eponymous GPL program, used mainly for converting the bitmap-based subtitles on DVDs to text data. There is no formal specification of the subtitle file format, perhaps because of its simplicity.\footnote{Some kind of ``specification'' can be found on the website of the Matroska codec, which can read \texttt{srt} files -- \url{http://matroska.org/technical/specs/subtitles/srt.html}.}

A \emph{SRT} file does not have any header and contains everything as plain text. Each subtitle item consists of three or four lines and is separated from the previous and the next one by an empty line. The first line is the order of the subtitle in the movie, the second line contains the absolute time in the movie when the subtitle shows up and when it disappears. The time is expressed with the precision of milliseconds. The next several lines contain the actual text of the subtitle. It can also contain simple HTML-like formatting tags, although support for those varies across media players.

MicroDVD \emph{sub} format is a format, used by the free but proprietary MicroDVD media player, which discontinued  development in 2001. This format also lacks any formal specification and support is usually worse among players.

In the MicroDVD \emph{sub} format, each line represents a subtitle item. Numbers of frames in the video between which the subtitle is displayed are used instead of the absolute time in seconds. After the frame numbers in brackets, the actual text of the subtitle follows. The pipe symbol is used as a line separator.

The are also some other proprietary formats having the extension \emph{.sub}, but they look differently.

For our purposes, we can take note of one important thing, partly visible in the example on top: not every subtitle item is a sentence -- sometimes, there are more sentences in one item, sometimes, there is one sentence split across many items. We describe how we dealt with this problem in the section~\ref{os:sentence_splitting}.

In the examples in Table~\ref{subtitleFormats}, a mixup of letters ``l'' and ``I'' can be noticed. This is indeed not an error on our part, but an error, caused by copying DVD subtitle to text file using programs like SubRip that use some light form of OCR to get the text information; and ``I'' and ``l'' often look indistinguishable in sans-serif fonts used often in the DVD subtitles.

Before the advent of fast internet connections, movies were often unofficially shared using just physical media; because of that, movies were sometimes split into multiple video files to be put on a separate CDs. For this reason, some subtitles are sometimes split in a half.

\subsection{Current Tools}

There are several freeware tools for amateur subtitle translation. They are usually standalone applications. The GUI of such applications typically consists of two columns, the first one with the subtitle items in the original language, the second one to be completed with the translation. Some of them offer also a synchronized playback of video during the translation. We did not find an application which would be web based and specialized on subtitles translation. An overview of such tools is in Table~\ref{subtitles_tools}.

\begin{table}[h]

\begin{center}
\begin{tabular}{|c|c|c|c|}
\hline
\bf name & \bf licence & \bf platform & \bf website \\
\hline
Subtitle Workshop 4 & freeware & Windows & www.urusoft.net \\
\hline
Subtitle Processor & GPL & Windows & sourceforge.net/projects/subtitleproc \\
\hline
Open Subtitle Translator & GPL & Windows / Linux & sourceforge.net/projects/opensub \\
\hline
Gnome Subtitles & GPL & Linux & sourceforge.net/projects/gnome-subtitles \\
\hline
Subtitles Translator & freeware & Windows & www.mironto.sk \\ \hline

\end{tabular}
\end{center}

\caption{An overview of subtitle translation tools available on the Internet.} \label{subtitles_tools}
\end{table}

From our view there is also an interesting project by Google -- \emph{Google Translator Toolkit}. It is a web application designed to help the translators with their work which also supports parsing subtitles. During their work, a translators can see the document both in source and target language and is given per sentence suggestions from Google Translate or their own translation memory which the user has previously imported. After the work is finished, the created translations can be exported as a translation memory archive. This tool did not became popular among translators, probably because of the quality of the machine translation provided. Professional translators would probably not be willing to bring their valuable translation memories to Google for free. 

\begin{figure}

\begin{center}
\includegraphics[scale=0.4]{./figures/google_translator_toolkit.png}
\end{center}

\caption{Google Translator Toolkit} \label{google_translator_toolkit}
\end{figure}

\section{Translation Memories}
\label{sec:translation_memories}
\subsection{What is a Translation Memory}

A \emph{translation memory} is a tool for computer-assisted human translation. The core idea behind translation memories is the assumption that sentences that are similar in the source language will likely have a similar translation in the target language. Then, if the tool is able to provide the translator with a translation of a similar sentence, there is a big chance that the provided sentence will require only small changes.

Translation memories are widely used in the translation industry, mostly while translating technical documentation and during the localization of software. In such cases the translators usually take advantage of the fact that the new version of the manual of a given software does not differ too much from the previous version. A survey \footnote{Elina Lagoudaki (2006), \emph{"Translation Memory systems: Enlightening users' perspective. Key finding of the TM Survey 2006 carried out during July and August 2006.} Imperial College London, Translation Memories Survey 2006, p.16} among companies producing multilingual documentation for their products in 2006 showed that 82.5\,\% out of 874 such companies use a TM system.

While using a translation memory there is usually a tendency to keep the database as clean as possible in terms of domain -- to contain only sentences relevant for translated topics. The reasons to do so are the effort to keep the database as small as possible in order to not make the database search too slow and not spoil the terminology that is used in the particular area. To keep the terminology consistent, domain glossaries are usually used.

There are several reasons why using translation memories makes the translators' work more efficient. The main advantage is that it reduces the cost and makes the translation process faster because the amount of the translator's work is smaller -- the work that has been done once can be easily reused. It helps to keep consistency of translation between multiple documents and also consistency with the previous versions of documents (e.g.\ technical manuals). It is also quite easy to ensure that each sentence of the original document was translated into a segment of the target language document.

There are also some obstacles in using translation memory systems. Professional Translation Memory Management Systems are very expensive and the maintenance of such system can be demanding as well. From the point of view of the quality of the translation, there is a danger that the translator could translate the text mechanically sentence by sentence instead of focusing on translating the message of the text.

In contrast to complete machine translation, it is still the human translator who controls the whole process of translation. Nevertheless, improvements in machine translation allow to provide a machine translation output together with TM candidates.

\subsection{Usual Implementation}

A simple option is to provide only candidate sentences where the sentences in the source language match  each other exactly. Usually, the database is relatively sparse and probably no sentences would be retrieved. In such cases a fuzzy matching algorithm is used to retrieve also similar sentences where the similarity is usually a metric based on the Levensthein editing distance.

Before using the translation memory itself, some preprocessing may be necessary. Often, text extraction is needed (e.g.\ in the case of localization of user interfaces). Sometimes, finding terminology or other named entities and segmentation to elementary units, usually sentences, is always done. This components can be either rule based or statistical.

During the translation process, the system retrieves similar sentences from the database of already translated sentences. Usually, sentences having the smallest letter based or word based \emph{Levensthein editing distance} are used. Despite this, we finally decided to use a different way of retrieving matches, this algorithm will be shortly described as the state of art in translation memories.

The Levensthein distance of two strings is the minimum number of edits (insertions, deletions and substitutions) which is needed to transform one string to another. A modification called Damerau–Levenshtein distance allowing also transposition of two adjacent letters can be also used.

Originally a bottom-up dynamic programming algorithm was used -- a distance of two strings is computed from the knowledge of the of the distance of one letter shorter prefixes. Later the Bitap algorithm used in Unix tool \emph{agrep} appeared. Theoretically also a finite state machine (Levenshtein transducer) can be constructed for Levensthein distance (see Figure~\ref{fig:levensthein_transducer}).

\begin{figure}
\begin{center}
\includegraphics[scale=0.65]{./figures/levensthein.pdf}
\end{center}

\caption{An example of the Levensthein transducer for the word \emph{"success"}. (Taken from the study material for the \emph{Information Retrieval Systems} course at MFF UK by Michal Kopecký.)}
\label{fig:levensthein_transducer}
\end{figure}

For bigger databases the online algorithms begin to be very slow a preprocessing of the database is necessary. Some sophisticated indexing methods are used, among them the suffix trees or $n$-gram indexes. The candidates retrieved from such indexes are later examined more carefully.

\subsection{Current TM Tools}

The tool most frequently used by professional translators is \emph{SDL Trados}. It was originally developed by the German company Trados which was later acquired by its biggest rival, British SDL. It became popular mostly because of its integration to Microsoft Office starting in the mid nineties. It is a very complex software. Except the actual tool for the end users, it includes central servers where a translation agency can gather its data and from where the data can be distributed to the translators' PCs and sophisticated tools for team work. Other popular translation memories are DeJaVu by the French company Atril and Wordfast by an American company of the same name. According to a 2006 survey\footnote{Elina Lagoudaki (2006): \emph{Translation Memories Survey 2006: Users' perceptions around TM use}. Translating and the Computer 2006, London: Aslib.} 54\,\% of professional translators world wide used products by Trados or SDL, 17\,\% Wordfast and 16\,\% Deja Vu.

There are also open source translation memories projects, mostly not very elaborate and with a small community. IBM has recently released its internally used software under the Eclipse Public Licence. A widely used open source tool is called \emph{OmegaT}. Is is a cross-platform software which provides very complex functionality. It can be interconnected with Trados servers, supports most of the translation memory formats and supports also many textual formats, but without integration to other software. It is also commonly used for translation of open source software. According to previously mentioned survey it is used by only 3\,\% of professional translators.

\begin{figure}
\begin{center}
\includegraphics[scale=.4]{./figures/omegat.png}
\end{center}

\caption{A screenshot of the OmegaT version 1.6}

\end{figure}

There is also a translation memory project which is somehow similar to our project. It is called \emph{MyMemory} and it was created by the Italian translation agency \emph{Translated.net}. It is a big general-purpose translation memory available as a remote service via the Internet. It contains translations from various domains, which can be used either separately or as a whole. The usage of MyMemory is free of charge, under the condition that the translations produced using the service will be provided as data to the service.
